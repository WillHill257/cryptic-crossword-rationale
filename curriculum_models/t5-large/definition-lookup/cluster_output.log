09/29/2022 08:46:38 - WARNING - __main__ - Process rank: -1, device: cuda:0, n_gpu: 1distributed training: False, 16-bits training: False
09/29/2022 08:46:38 - INFO - __main__ - Training/evaluation parameters Seq2SeqTrainingArguments(
_n_gpu=1,
adafactor=False,
adam_beta1=0.9,
adam_beta2=0.999,
adam_epsilon=1e-08,
auto_find_batch_size=False,
bf16=False,
bf16_full_eval=False,
data_seed=None,
dataloader_drop_last=False,
dataloader_num_workers=0,
dataloader_pin_memory=True,
ddp_bucket_cap_mb=None,
ddp_find_unused_parameters=None,
debug=[],
deepspeed=None,
disable_tqdm=False,
do_eval=False,
do_predict=False,
do_train=True,
eval_accumulation_steps=None,
eval_delay=0,
eval_steps=None,
evaluation_strategy=no,
fp16=False,
fp16_backend=auto,
fp16_full_eval=False,
fp16_opt_level=O1,
fsdp=[],
fsdp_min_num_params=0,
fsdp_transformer_layer_cls_to_wrap=None,
full_determinism=False,
generation_max_length=None,
generation_num_beams=None,
gradient_accumulation_steps=1,
gradient_checkpointing=False,
greater_is_better=None,
group_by_length=False,
half_precision_backend=auto,
hub_model_id=None,
hub_private_repo=False,
hub_strategy=every_save,
hub_token=<HUB_TOKEN>,
ignore_data_skip=False,
include_inputs_for_metrics=False,
jit_mode_eval=False,
label_names=None,
label_smoothing_factor=0.0,
learning_rate=5e-05,
length_column_name=length,
load_best_model_at_end=False,
local_rank=-1,
log_level=-1,
log_level_replica=-1,
log_on_each_node=True,
logging_dir=../curriculum_models/runs/Sep29_08-46-36_mscluster25.ms.wits.ac.za,
logging_first_step=False,
logging_nan_inf_filter=True,
logging_steps=500,
logging_strategy=steps,
lr_scheduler_type=linear,
max_grad_norm=1.0,
max_steps=-1,
metric_for_best_model=None,
mp_parameters=,
no_cuda=False,
num_train_epochs=3,
optim=adamw_hf,
output_dir=../curriculum_models/t5-large/definition-lookup,
overwrite_output_dir=False,
past_index=-1,
per_device_eval_batch_size=8,
per_device_train_batch_size=8,
predict_with_generate=False,
prediction_loss_only=False,
push_to_hub=False,
push_to_hub_model_id=None,
push_to_hub_organization=None,
push_to_hub_token=<PUSH_TO_HUB_TOKEN>,
ray_scope=last,
remove_unused_columns=True,
report_to=[],
resume_from_checkpoint=True,
run_name=../curriculum_models/,
save_on_each_node=False,
save_steps=5000,
save_strategy=steps,
save_total_limit=None,
seed=42,
sharded_ddp=[],
skip_memory_metrics=True,
sortish_sampler=False,
tf32=None,
torchdynamo=None,
tpu_metrics_debug=False,
tpu_num_cores=None,
use_ipex=False,
use_legacy_prediction_loop=False,
warmup_ratio=0.0,
warmup_steps=0,
weight_decay=0.0,
xpu_backend=None,
)
09/29/2022 08:46:39 - WARNING - datasets.builder - Using custom data configuration default-c40a0d127a42e584
09/29/2022 08:46:39 - INFO - datasets.builder - Overwrite dataset info from restored data version.
09/29/2022 08:46:39 - INFO - datasets.info - Loading Dataset info from ./models/cache/json/default-c40a0d127a42e584/0.0.0/a3e658c4731e59120d44081ac10bf85dc7e1388126b92338344ce9661907f253
09/29/2022 08:46:41 - WARNING - datasets.builder - Reusing dataset json (./models/cache/json/default-c40a0d127a42e584/0.0.0/a3e658c4731e59120d44081ac10bf85dc7e1388126b92338344ce9661907f253)
09/29/2022 08:46:41 - INFO - datasets.info - Loading Dataset info from ./models/cache/json/default-c40a0d127a42e584/0.0.0/a3e658c4731e59120d44081ac10bf85dc7e1388126b92338344ce9661907f253
09/29/2022 08:47:02 - INFO - __main__ - Loaded the curriculum dataset:
DatasetDict({
    train: Dataset({
        features: ['idx', 'input', 'target'],
        num_rows: 2566038
    })
})
09/29/2022 08:47:03 - WARNING - datasets.arrow_dataset - Loading cached processed dataset at ./models/cache/json/default-c40a0d127a42e584/0.0.0/a3e658c4731e59120d44081ac10bf85dc7e1388126b92338344ce9661907f253/cache-42ef2ab76cbc051d.arrow
09/29/2022 08:47:03 - WARNING - datasets.arrow_dataset - Loading cached processed dataset at ./models/cache/json/default-c40a0d127a42e584/0.0.0/a3e658c4731e59120d44081ac10bf85dc7e1388126b92338344ce9661907f253/cache-c0f29d23bf07778e.arrow
09/29/2022 08:47:03 - WARNING - datasets.arrow_dataset - Loading cached processed dataset at ./models/cache/json/default-c40a0d127a42e584/0.0.0/a3e658c4731e59120d44081ac10bf85dc7e1388126b92338344ce9661907f253/cache-64bd241830a0f130.arrow
09/29/2022 08:47:03 - WARNING - datasets.arrow_dataset - Loading cached processed dataset at ./models/cache/json/default-c40a0d127a42e584/0.0.0/a3e658c4731e59120d44081ac10bf85dc7e1388126b92338344ce9661907f253/cache-ca0bc5ced2acc271.arrow
09/29/2022 08:47:03 - WARNING - datasets.arrow_dataset - Loading cached processed dataset at ./models/cache/json/default-c40a0d127a42e584/0.0.0/a3e658c4731e59120d44081ac10bf85dc7e1388126b92338344ce9661907f253/cache-9e8e8b420aba4caf.arrow
{'loss': 1.0629, 'learning_rate': 2.17014024203312e-06, 'epoch': 2.87}
{'loss': 1.0399, 'learning_rate': 2.1441598728001127e-06, 'epoch': 2.87}
{'loss': 1.0859, 'learning_rate': 2.118179503567105e-06, 'epoch': 2.87}
{'loss': 1.0989, 'learning_rate': 2.0921991343340974e-06, 'epoch': 2.87}
{'loss': 1.0644, 'learning_rate': 2.0662187651010896e-06, 'epoch': 2.88}
{'loss': 1.0726, 'learning_rate': 2.040238395868082e-06, 'epoch': 2.88}
{'loss': 1.0801, 'learning_rate': 2.0142580266350743e-06, 'epoch': 2.88}
{'loss': 1.0709, 'learning_rate': 1.988277657402067e-06, 'epoch': 2.88}
{'loss': 1.0601, 'learning_rate': 1.9622972881690595e-06, 'epoch': 2.88}
{'loss': 1.0773, 'learning_rate': 1.936316918936052e-06, 'epoch': 2.88}
{'loss': 1.0348, 'learning_rate': 1.9103365497030446e-06, 'epoch': 2.89}
{'loss': 1.0465, 'learning_rate': 1.8843561804700368e-06, 'epoch': 2.89}
{'loss': 1.0758, 'learning_rate': 1.8583758112370294e-06, 'epoch': 2.89}
{'loss': 1.0562, 'learning_rate': 1.832395442004022e-06, 'epoch': 2.89}
{'loss': 1.0677, 'learning_rate': 1.8064150727710145e-06, 'epoch': 2.89}
{'loss': 1.0595, 'learning_rate': 1.7804347035380069e-06, 'epoch': 2.89}
{'loss': 1.0469, 'learning_rate': 1.754454334304999e-06, 'epoch': 2.89}
{'loss': 1.0652, 'learning_rate': 1.7284739650719916e-06, 'epoch': 2.9}
{'loss': 1.0638, 'learning_rate': 1.7024935958389842e-06, 'epoch': 2.9}
{'loss': 1.0811, 'learning_rate': 1.6765132266059768e-06, 'epoch': 2.9}
{'loss': 1.0823, 'learning_rate': 1.650532857372969e-06, 'epoch': 2.9}
{'loss': 1.069, 'learning_rate': 1.6245524881399615e-06, 'epoch': 2.9}
{'loss': 1.0565, 'learning_rate': 1.598572118906954e-06, 'epoch': 2.9}
{'loss': 1.0841, 'learning_rate': 1.5725917496739464e-06, 'epoch': 2.91}
{'loss': 1.0381, 'learning_rate': 1.5466113804409388e-06, 'epoch': 2.91}
{'loss': 1.0539, 'learning_rate': 1.5206310112079314e-06, 'epoch': 2.91}
{'loss': 1.0569, 'learning_rate': 1.4946506419749238e-06, 'epoch': 2.91}
{'loss': 1.036, 'learning_rate': 1.4686702727419163e-06, 'epoch': 2.91}
{'loss': 1.0838, 'learning_rate': 1.4426899035089087e-06, 'epoch': 2.91}
{'loss': 1.0453, 'learning_rate': 1.4167095342759013e-06, 'epoch': 2.91}
{'loss': 1.0714, 'learning_rate': 1.3907291650428936e-06, 'epoch': 2.92}
{'loss': 1.0557, 'learning_rate': 1.364748795809886e-06, 'epoch': 2.92}
{'loss': 1.0975, 'learning_rate': 1.3387684265768786e-06, 'epoch': 2.92}
{'loss': 1.0888, 'learning_rate': 1.312788057343871e-06, 'epoch': 2.92}
{'loss': 1.0869, 'learning_rate': 1.2868076881108635e-06, 'epoch': 2.92}
{'loss': 1.0581, 'learning_rate': 1.260827318877856e-06, 'epoch': 2.92}
{'loss': 1.0813, 'learning_rate': 1.2348469496448485e-06, 'epoch': 2.93}
{'loss': 1.0736, 'learning_rate': 1.2088665804118408e-06, 'epoch': 2.93}
{'loss': 1.0505, 'learning_rate': 1.1828862111788334e-06, 'epoch': 2.93}
{'loss': 1.1063, 'learning_rate': 1.1569058419458258e-06, 'epoch': 2.93}
{'loss': 1.082, 'learning_rate': 1.1309254727128182e-06, 'epoch': 2.93}
{'loss': 1.0587, 'learning_rate': 1.1049451034798107e-06, 'epoch': 2.93}
{'loss': 1.0841, 'learning_rate': 1.078964734246803e-06, 'epoch': 2.94}
{'loss': 1.0834, 'learning_rate': 1.0529843650137957e-06, 'epoch': 2.94}
{'loss': 1.0648, 'learning_rate': 1.027003995780788e-06, 'epoch': 2.94}
{'loss': 1.09, 'learning_rate': 1.0010236265477806e-06, 'epoch': 2.94}
{'loss': 1.0573, 'learning_rate': 9.75043257314773e-07, 'epoch': 2.94}
{'loss': 1.0799, 'learning_rate': 9.490628880817655e-07, 'epoch': 2.94}
{'loss': 1.0842, 'learning_rate': 9.23082518848758e-07, 'epoch': 2.94}
{'loss': 1.0524, 'learning_rate': 8.971021496157504e-07, 'epoch': 2.95}
{'loss': 1.0595, 'learning_rate': 8.711217803827429e-07, 'epoch': 2.95}
{'loss': 1.0419, 'learning_rate': 8.451414111497352e-07, 'epoch': 2.95}
{'loss': 1.0621, 'learning_rate': 8.191610419167278e-07, 'epoch': 2.95}
{'loss': 1.0863, 'learning_rate': 7.931806726837202e-07, 'epoch': 2.95}
{'loss': 1.0703, 'learning_rate': 7.672003034507127e-07, 'epoch': 2.95}
{'loss': 1.0681, 'learning_rate': 7.412199342177051e-07, 'epoch': 2.96}
{'loss': 1.0493, 'learning_rate': 7.152395649846976e-07, 'epoch': 2.96}
{'loss': 1.0805, 'learning_rate': 6.892591957516901e-07, 'epoch': 2.96}
{'loss': 1.0955, 'learning_rate': 6.632788265186824e-07, 'epoch': 2.96}
{'loss': 1.075, 'learning_rate': 6.37298457285675e-07, 'epoch': 2.96}
{'loss': 1.0469, 'learning_rate': 6.113180880526675e-07, 'epoch': 2.96}
{'loss': 1.0797, 'learning_rate': 5.853377188196599e-07, 'epoch': 2.96}
{'loss': 1.0838, 'learning_rate': 5.593573495866523e-07, 'epoch': 2.97}
{'loss': 1.061, 'learning_rate': 5.333769803536448e-07, 'epoch': 2.97}
{'loss': 1.0673, 'learning_rate': 5.073966111206373e-07, 'epoch': 2.97}
{'loss': 1.0815, 'learning_rate': 4.814162418876296e-07, 'epoch': 2.97}
{'loss': 1.0613, 'learning_rate': 4.554358726546222e-07, 'epoch': 2.97}
{'loss': 1.0774, 'learning_rate': 4.294555034216147e-07, 'epoch': 2.97}
{'loss': 1.0966, 'learning_rate': 4.034751341886071e-07, 'epoch': 2.98}
{'loss': 1.1152, 'learning_rate': 3.774947649555996e-07, 'epoch': 2.98}
{'loss': 1.0703, 'learning_rate': 3.51514395722592e-07, 'epoch': 2.98}
{'loss': 1.0554, 'learning_rate': 3.255340264895845e-07, 'epoch': 2.98}
{'loss': 1.0725, 'learning_rate': 2.995536572565769e-07, 'epoch': 2.98}
{'loss': 1.0729, 'learning_rate': 2.7357328802356943e-07, 'epoch': 2.98}
{'loss': 1.0368, 'learning_rate': 2.4759291879056185e-07, 'epoch': 2.99}
{'loss': 1.0773, 'learning_rate': 2.2161254955755432e-07, 'epoch': 2.99}
{'loss': 1.0613, 'learning_rate': 1.9563218032454677e-07, 'epoch': 2.99}
{'loss': 1.0363, 'learning_rate': 1.6965181109153924e-07, 'epoch': 2.99}
{'loss': 1.071, 'learning_rate': 1.436714418585317e-07, 'epoch': 2.99}
{'loss': 1.0805, 'learning_rate': 1.1769107262552416e-07, 'epoch': 2.99}
{'loss': 1.0365, 'learning_rate': 9.171070339251662e-08, 'epoch': 2.99}
{'loss': 1.072, 'learning_rate': 6.573033415950908e-08, 'epoch': 3.0}
{'loss': 1.0514, 'learning_rate': 3.9749964926501536e-08, 'epoch': 3.0}
{'loss': 1.0727, 'learning_rate': 1.3769595693493998e-08, 'epoch': 3.0}
{'train_runtime': 9706.217, 'train_samples_per_second': 793.112, 'train_steps_per_second': 99.139, 'train_loss': 0.04694390503252539, 'epoch': 3.0}
***** train metrics *****
  epoch                    =        3.0
  train_loss               =     0.0469
  train_runtime            = 2:41:46.21
  train_samples            =    2566038
  train_samples_per_second =    793.112
  train_steps_per_second   =     99.139
